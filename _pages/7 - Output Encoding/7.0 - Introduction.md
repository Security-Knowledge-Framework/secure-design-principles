---
title: Output Encoding and XSS
author: Riccardo ten Cate
date: 03-12-2024
category: Jekyll
layout: post
---

Cross-Site Scripting (XSS) is one of the most widespread and dangerous vulnerabilities in web applications. It occurs when untrusted data is included in a web page without proper output encoding, allowing an attacker to execute malicious JavaScript in another user's browser. Unlike server-side attacks, XSS targets the client-side environment, exploiting how browsers render and execute dynamic content. The malicious script runs with the same privileges as the legitimate site, making it possible for attackers to hijack sessions, deface content, steal cookies or localStorage tokens, and perform actions on behalf of users.

There are several forms of XSS, including reflected, stored, and DOM-based. Reflected XSS occurs when input is immediately echoed back in the HTTP response (e.g., via a query parameter), while stored XSS involves input being saved on the server and displayed to others later (e.g., in a comment section). DOM-based XSS stems from insecure handling of data within JavaScript itself. All types can lead to serious consequences, especially if sensitive data or actions (like money transfers or password resets) are accessible to the script. The danger is magnified in Single Page Applications (SPAs), where client-side logic handles much of the rendering and routing.

One of the most dangerous aspects of XSS is that it allows attackers to operate entirely within the context of a legitimate, authenticated user. This means that beyond just stealing session cookies or tokens, which can already grant full access to a victim’s account, the attacker can also perform arbitrary actions on behalf of that user through session riding. For example, once a malicious script runs in a user’s browser, it can silently make authenticated requests using the user’s cookies, CSRF tokens, or stored credentials. In a healthcare context, this could allow an attacker to view or modify electronic health records (EHRs), submit fraudulent insurance claims, alter patient prescriptions, or access confidential physician notes. If the compromised user is a clinician, attacker-controlled scripts could even initiate referrals, download sensitive lab results, or access privileged audit logs. Since these actions are carried out by the browser under the guise of a legitimate session, server-side protections often cannot distinguish them from genuine user activity. This makes XSS not just a data exposure risk, but a full remote control vulnerability over user accounts.